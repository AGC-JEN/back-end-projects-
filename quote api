const express = require('express');
const app = express();

const { quotes } = require('./data');
const { getRandomElement } = require('./utils');

const PORT = process.env.PORT || 4001;

// Serve front-end
app.use(express.static('public'));

/**
 * GET /api/quotes/random
 * Return a random quote object
 */
app.get('/api/quotes/random', (req, res) => {
  const randomQuote = getRandomElement(quotes);
  res.send({ quote: randomQuote });
});

/**
 * GET /api/quotes
 * Return all quotes OR all quotes by a specific person
 */
app.get('/api/quotes', (req, res) => {
  const { person } = req.query;

  if (person) {
    const filteredQuotes = quotes.filter(q => q.person === person);
    res.send({ quotes: filteredQuotes });
  } else {
    res.send({ quotes: quotes });
  }
});

/**
 * POST /api/quotes
 * Add a new quote (passed through query string)
 * Requires: person AND quote
 */
app.post('/api/quotes', (req, res) => {
  const { person, quote } = req.query;

  if (!person || !quote) {
    return res.status(400).send();
  }

  const newQuote = { person, quote };
  quotes.push(newQuote);

  res.send({ quote: newQuote });
});

// Start server
app.listen(PORT, () => {
  console.log(`Server is listening on port ${PORT}`);
});

node server.js
http://localhost:4001

